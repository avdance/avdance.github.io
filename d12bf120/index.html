<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="icon" type="image/png" sizes="32x32" href="/images/avdance32_32.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/avdance16_16.ico"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"blog.avdancedu.com",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!0,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="向量&#x2F;矢量vector，在数学里称为向量，在物量学中称为矢量，其实两者是同一个意思。向量&#x2F;矢量由字符 $\vec{a}$ 或粗体的 a 表示。"><meta property="og:type" content="article"><meta property="og:title" content="计算机图形学基础知识"><meta property="og:url" content="https://blog.avdancedu.com/d12bf120/index.html"><meta property="og:site_name" content="音视跳动科技"><meta property="og:description" content="向量&#x2F;矢量vector，在数学里称为向量，在物量学中称为矢量，其实两者是同一个意思。向量&#x2F;矢量由字符 $\vec{a}$ 或粗体的 a 表示。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://blog.avdancedu.com/m-vector.png"><meta property="og:image" content="https://blog.avdancedu.com/%E5%90%91%E9%87%8F%E5%8A%A0%E6%B3%95%E8%BF%90%E7%AE%97-%E5%AF%BC%E5%87%BA.png"><meta property="og:image" content="https://blog.avdancedu.com/myvec.png"><meta property="og:image" content="https://blog.avdancedu.com/%E7%82%B9%E4%B9%98-%E5%AF%BC%E5%87%BA.png"><meta property="og:image" content="https://blog.avdancedu.com/cross.png"><meta property="article:published_time" content="2023-02-20T10:05:02.514Z"><meta property="article:modified_time" content="2023-02-20T10:05:02.514Z"><meta property="article:author" content="音视跳动"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog.avdancedu.com/m-vector.png"><link rel="canonical" href="https://blog.avdancedu.com/d12bf120/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>计算机图形学基础知识 | 音视跳动科技</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="音视跳动科技" type="application/atom+xml"></head><body itemscope itemtype="https://schema.org/WebPage"><div class="container"><div class="headband"></div><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div><header class="header" itemscope itemtype="https://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">音视跳动科技</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">传播最前沿的科技知识！</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/avdance" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="https://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.avdancedu.com/d12bf120/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="image" content="/images/avdancelogo.jpg"><meta itemprop="name" content="音视跳动"><meta itemprop="description" content="传输最前沿的科技知识，学习音视频的圣地！ffmpeg, webrtc, H264, AAC"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="音视跳动科技"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 计算机图形学基础知识</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2023-02-20 18:05:02" itemprop="dateCreated datePublished" datetime="2023-02-20T18:05:02+08:00">2023-02-20</time></span><span id="/d12bf120/" class="post-meta-item leancloud_visitors" data-flag-title="计算机图形学基础知识" title="阅读次数"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span class="leancloud-visitors-count"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span> <span class="post-meta-item-text">Valine：</span><a title="valine" href="/d12bf120/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/d12bf120/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>2.8k</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="向量-矢量"><a href="#向量-矢量" class="headerlink" title="向量/矢量"></a>向量/矢量</h2><p>vector，在数学里称为<strong>向量</strong>，在物量学中称为<strong>矢量</strong>，其实两者是同一个意思。<br><strong>向量/矢量</strong>由字符 $\vec{a}$ 或粗体的 <strong>a</strong> 表示。</p><a id="more"></a><p><img data-src="../../../../m-vector.png" alt=""></p><p>如上图所示，从A点到B点的向量就是用B坐标减去A坐标，公式如下：$\vec{AB}=B - A$。</p><p>我们需要知，向量有两个重要的属性，即 <strong>方向</strong> 和 <strong>长度</strong>。</p><blockquote><p>注意，当向量平移后，在方向不变，且长度不变的情况下，它们代表同一个向量。</p></blockquote><p>其中，向量的长度由 $||\vec{AB}||$ 表示。</p><p>向量的方向由 $\hat{a} = \frac{ \vec{a} }{\Vert\vec{a}\Vert}$ 表示。它也称为一个 <strong>单位向量</strong>。</p><h2 id="向量的加法"><a href="#向量的加法" class="headerlink" title="向量的加法"></a>向量的加法</h2><p>两个向量相加，有<strong>几何</strong>和<strong>代数</strong>两种方法。</p><p>几何法又分为 <strong>平行四边形法</strong> 和 <strong>三角形法</strong>。如下图所示：<br><img data-src="../../../../%E5%90%91%E9%87%8F%E5%8A%A0%E6%B3%95%E8%BF%90%E7%AE%97-%E5%AF%BC%E5%87%BA.png" alt=""></p><p>以上图为例，$\vec{a}$ 与 $\vec{b}$ 相加后，新向量的起始点为A的坐标，终止点为B的坐标。当多个向量相加时，依次类推… …</p><p>下面我们来看一下代数法。</p><p>首先咱们来看一下一个向量在代数中该如何表示，如下图所示：<br><img data-src="../../../../myvec.png" alt=""></p><p>从上图中可以看到，（0，0）点到B点的向量是由4个X和3个Y相加的和，换成矩阵表示如下：<br>$$<br>\vec{AB} =<br>\begin{pmatrix}<br>{ x } \<br>{ y}<br>\end{pmatrix}<br>$$</p><p>在图形学中，默认每个项量是坚着排列的，即列向量。</p><h2 id="转置"><a href="#转置" class="headerlink" title="转置"></a>转置</h2><p>可以将列向量转成行向量，或相反操作，这就是转置。<br>比如下面这个向量矩阵<br>$$<br>\vec{AB} =<br>\begin{pmatrix}<br>{ x } \<br>{ y}<br>\end{pmatrix}<br>$$<br>转置后，成了下面的样子：<br>$$<br>\vec{AB}^\top =<br>\begin{pmatrix}<br>{ x, y}<br>\end{pmatrix}<br>$$</p><p>如果求向量的长度，在直角坐标系统可以使用勾股定理计算。公式如下：<br>$$<br>{\Vert\vec{AB}\Vert} =<br>\begin{equation<em>}<br>\sqrt{x^2 + y^2}<br>\end{equation</em>}<br>$$</p><h2 id="向量的乘法"><a href="#向量的乘法" class="headerlink" title="向量的乘法"></a>向量的乘法</h2><p>向量的乘法分为 <strong>点乘</strong> 和 <strong>叉乘</strong>。</p><h3 id="点乘"><a href="#点乘" class="headerlink" title="点乘"></a>点乘</h3><p>首先看一下<strong>点乘</strong>，如下图所示：<br><img data-src="../../../../%E7%82%B9%E4%B9%98-%E5%AF%BC%E5%87%BA.png" alt=""></p><p>如上图所示，点乘的意思是指向量 $\vec{a}$ 的长度 <strong>乘以</strong> 向量 $\vec{b}$ 的长度，再乘它们的夹角的 $cos\theta$。公式如下:</p><p>$$<br> \vec{a} \cdot \vec{b} = \Vert{a}\Vert \Vert \vec{b} \Vert cos\theta<br> $$</p><p>该公式的一个特点是，两个向量相乘，得到的是一个确定的值。</p><p>将上述公式做一个变换，我们可以得到下面的公式：<br>$$<br>cos\theta = \frac { \vec{a} \cdot \vec{b} }{\Vert \vec{a} \Vert \Vert \vec{b} \Vert}<br>$$</p><p>从该公式中可以知道，两个向量的点乘，除以它们的长度，就得到了向量的角度。此时，如果向量是单位向量（其长度为1），则得到如下公式:<br>$$<br>cos\theta = \hat{a} \cdot \hat{b}<br>$$</p><p>除了上面我们要了解的知识外，点乘与数字乘法相似，它支持<strong>交换律</strong>、<strong>结合律</strong>和<strong>分配律</strong>。<br>$$<br>\vec{a}\cdot\vec{b} = \vec{b}\cdot\vec{a} \<br>\vec{a}\cdot(\vec{b}+\vec{c}) = \vec{a}\cdot\vec{b} + \vec{a}\cdot\vec{c} \<br>(k\vec{a})\cdot\vec{b} = \vec{a}\cdot(k\vec{b}) = k(\vec{a}\cdot\vec{b})<br>$$</p><p>在二维空间中，两个向量点乘计算如下：<br>$$<br>\vec{a}\cdot\vec{b} =<br>\begin{pmatrix}<br>{x_{a}}\<br>{y_{a}}<br>\end{pmatrix}<br>\cdot<br>\begin{pmatrix}<br>{x_{b}} \<br>{y_{b}}<br>\end{pmatrix}<br>= x_{a}x{b} + y_{a}y_{b}<br>$$</p><p>在三维空间中，两个向量的点乘计算如下：<br>$$<br>\vec{a}\cdot\vec{b} =<br>\begin{pmatrix}<br>{x_{a}}\<br>{y_{a}}\<br>{z_{a}}<br>\end{pmatrix}<br>\cdot<br>\begin{pmatrix}<br>{x_{b}} \<br>{y_{b}} \<br>{z_{b}}<br>\end{pmatrix}<br>= x_{a}x{b} + y_{a}y_{b}+z_{a}z_{b}<br>$$</p><h3 id="叉乘"><a href="#叉乘" class="headerlink" title="叉乘"></a>叉乘</h3><p>叉乘主要用于建立3维模型，如下图所示:<br><img data-src="../../../../cross.png" alt=""></p><blockquote><p>在图形学中我们始终采用右手坐标系，像OpenGL使用的是右手坐标系，这一点需要注意。</p></blockquote><p>$\vec{a}$与$\vec{b}$的叉乘公式如下：<br>$$<br>\vec{a} * \vec{b} = -\vec{b} * \vec{a} \<br>\Vert \vec{a} * \vec{b} \Vert = \Vert \vec{a} \Vert \Vert \vec{b} \Vert sin\theta<br>$$</p><p>叉乘有以下几个公式<br>$$<br>\vec{x} * \vec{y} = \vec{z} (x向量叉乘y向量，得到z向量) \<br>\vec{y} * \vec{x} = -\vec{z} (当x与y向量交换时，得到一个相反的z向量，右手法则) \<br>\vec{y} * \vec{z} = \vec{x} (根据右手法则，y向量叉乘z向量，得到x向量) \<br>\vec{z} * \vec{y} = - \vec{x} (当z与y位置交换时，得到相反的x向量) \<br>\vec{z} * \vec{x} = \vec{y} (根据右手法则，z与x叉乘x，得到向量y) \<br>\vec{x} * \vec{z} = - \vec{y} \<br>\<br>\vec{a} * \vec{a} = \vec{0} \<br>\vec{a} * (\vec{b} + \vec{c}) = \vec{a} * \vec{b} + \vec{a} + \vec{c} \<br>\vec{a} * (k\vec{b}) = k(\vec{a} * \vec{b})<br>$$</p><p>叉乘的计算比较复杂，后面再详细讲… …</p><p>叉乘有什么作用呢？它有两个作用，一个是判断左、右；另一个是判定内、外。</p><ul><li>如果$\vec{a} * \vec{b}$为正值，说明$\vec{ b}$在$\vec{a}$的左侧，反之$\vec{b}$在$\vec{a}$的右侧。</li><li>如果一个点在一个三角形的每个边的左边或右边，说明这个点在三角形内部。</li></ul><h2 id="矩阵的乘法"><a href="#矩阵的乘法" class="headerlink" title="矩阵的乘法"></a>矩阵的乘法</h2><p>矩阵乘法公式：<br>$$<br>（M * N)（N * P) = (M * P)<br>$$<br>需要注意的是，矩阵的乘法<strong>没有交换律</strong></p><p>但它有结合律，结合律，如：<br>$$<br>(AB)C = A(BC) \<br>A(B+C)=AB+AC<br>$$</p><p>矩阵乘积的转置等于后一个矩阵的转置再乘以前一个矩阵的转置<br>$$<br>(AB)^\top = B^\top A^\top<br>$$</p><h2 id="单位矩阵"><a href="#单位矩阵" class="headerlink" title="单位矩阵"></a>单位矩阵</h2><p>行列数相同，且斜对角全为1的矩阵，称为单位矩阵。如下所示：<br>$$<br>I_{3\times3}<br>\begin{pmatrix}<br>{1} &amp;&amp; {0} &amp;&amp; {0} \<br>{0} &amp;&amp; {1} &amp;&amp; {0} \<br>{1} &amp;&amp; {0} &amp;&amp; {0}<br>\end{pmatrix}<br>$$</p><p>单位矩阵的作用</p><h2 id="变换"><a href="#变换" class="headerlink" title="变换"></a>变换</h2></div><div class="reward-container"><div></div> <button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'> 打赏</button><div id="qr" style="display:none"><div style="display:inline-block"> <img src="https://cdn.avdancedu.com/image/next/wechat.jpeg" alt="音视跳动 微信支付"><p>微信支付</p></div><div style="display:inline-block"> <img src="https://cdn.avdancedu.com/image/next/alipay.jpeg" alt="音视跳动 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 音视跳动-李超 [avdance@163.com]</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://blog.avdancedu.com/d12bf120/" title="计算机图形学基础知识">https://blog.avdancedu.com/d12bf120/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><p>欢迎关注我的其它发布渠道</p><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="https://cdn.avdancedu.com/image/next/WeChat.jpeg"><span class="icon"><i class="fa fa-wechat"></i></span> <span class="label">WeChat</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/befa4615/" rel="prev" title="少儿python"><i class="fa fa-chevron-left"></i> 少儿python</a></div><div class="post-nav-item"> <a href="/75e8ef30/" rel="next" title="Vue经验点滴">Vue经验点滴<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#向量-矢量"><span class="nav-number">1.</span> <span class="nav-text">向量&#x2F;矢量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#向量的加法"><span class="nav-number">2.</span> <span class="nav-text">向量的加法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#转置"><span class="nav-number">3.</span> <span class="nav-text">转置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#向量的乘法"><span class="nav-number">4.</span> <span class="nav-text">向量的乘法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#点乘"><span class="nav-number">4.1.</span> <span class="nav-text">点乘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#叉乘"><span class="nav-number">4.2.</span> <span class="nav-text">叉乘</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#矩阵的乘法"><span class="nav-number">5.</span> <span class="nav-text">矩阵的乘法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单位矩阵"><span class="nav-number">6.</span> <span class="nav-text">单位矩阵</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#变换"><span class="nav-number">7.</span> <span class="nav-text">变换</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="https://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="音视跳动" src="/images/avdancelogo.jpg"><p class="site-author-name" itemprop="name">音视跳动</p><div class="site-description" itemprop="description">传输最前沿的科技知识，学习音视频的圣地！ffmpeg, webrtc, H264, AAC</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">59</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">17</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">34</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/avdance" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;avdance" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/garrylea/posts" title="ZhiHu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;garrylea&#x2F;posts" rel="noopener" target="_blank"><i class="fa fa-fw fa-zhihu"></i> ZhiHu</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="https://www.beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备19056322号-1</a> <img src="/images/beianico.png" style="display:inline-block"><a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11011102001366" rel="noopener" target="_blank">京公网安备11011102001366号</a></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2023</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">李超</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span title="站点总字数">254k</span></div><script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"Cu6h7B3RnNt3uEMrRWpVlIU6-gzGzoHsz","app_key":"5dKv9XFD2w3gjJnb0xnWIIWz","server_url":"https://leancloud.cn","security":false};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        //if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("Cu6h7B3RnNt3uEMrRWpVlIU6-gzGzoHsz","5dKv9XFD2w3gjJnb0xnWIIWz")</script><script>function showTime(e){var t=new AV.Query(e),c=[],u=$(".leancloud_visitors");u.each(function(){c.push($(this).attr("id").trim())}),t.containedIn("url",c),t.find().done(function(e){var t=".leancloud-visitors-count";if(0!==e.length){for(var n=0;n<e.length;n++){var o=e[n],i=o.get("url"),s=o.get("time"),r=document.getElementById(i);$(r).find(t).text(s)}for(n=0;n<c.length;n++){i=c[n],r=document.getElementById(i);var l=$(r).find(t);""==l.text()&&l.text(0)}}else u.find(t).text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(i){var e=$(".leancloud_visitors"),s=e.attr("id").trim(),r=e.attr("data-flag-title").trim(),t=new AV.Query(i);t.equalTo("url",s),t.find({success:function(e){if(0<e.length){var t=e[0];t.fetchWhenSave(!0),t.increment("time"),t.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var n=new i,o=new AV.ACL;o.setPublicReadAccess(!0),o.setPublicWriteAccess(!0),n.setACL(o),n.set("title",r),n.set("url",s),n.set("time",1),n.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):1<$(".post-title-link").length&&showTime(e)})</script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.min.css"><script src="/lib/needsharebutton/needsharebutton.min.js"></script><script>flOptions={iconStyle:"box",boxForm:"horizontal",position:"topRight",networks:"Weibo,Wechat,QQZone"},new needShareButton("#needsharebutton-float",flOptions)</script><script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('/lib/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'Cu6h7B3RnNt3uEMrRWpVlIU6-gzGzoHsz',
      appKey     : '5dKv9XFD2w3gjJnb0xnWIIWz',
      placeholder: "畅所欲言？",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script></body></html>