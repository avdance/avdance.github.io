<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/avdance32_32.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/avdance16_16.ico"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"blog.avdancedu.com",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!0,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="随着技术的进步，浏览器在未来会扮演越来越得要的角色。我们基本可以确定，在不久的将来，大部分Native应用都会被Web应用所替代。因此，如果你想今后想找一份好工作，或写出更高效的Web应用，就必须要了解一下浏览器的工作原理。 了解浏览器工作原理的方法有很多，但对Chrome源码的阅读无缝是第一位的，只有这样我们才能获取第一手材料。 而阅读Chrome源码的第一位就是要能够下载或编译Chrome源码"><meta property="og:type" content="article"><meta property="og:title" content="Windows下编译Chrome浏览器"><meta property="og:url" content="https://blog.avdancedu.com/a5b21a51/index.html"><meta property="og:site_name" content="音视跳动科技"><meta property="og:description" content="随着技术的进步，浏览器在未来会扮演越来越得要的角色。我们基本可以确定，在不久的将来，大部分Native应用都会被Web应用所替代。因此，如果你想今后想找一份好工作，或写出更高效的Web应用，就必须要了解一下浏览器的工作原理。 了解浏览器工作原理的方法有很多，但对Chrome源码的阅读无缝是第一位的，只有这样我们才能获取第一手材料。 而阅读Chrome源码的第一位就是要能够下载或编译Chrome源码"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2023-03-01T05:16:00.000Z"><meta property="article:modified_time" content="2023-03-01T05:17:37.720Z"><meta property="article:author" content="音视跳动"><meta property="article:tag" content="Chrome"><meta property="article:tag" content="windows"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://blog.avdancedu.com/a5b21a51/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Windows下编译Chrome浏览器 | 音视跳动科技</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="音视跳动科技" type="application/atom+xml"></head><body itemscope itemtype="https://schema.org/WebPage"><div class="container"><div class="headband"></div><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div><header class="header" itemscope itemtype="https://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">音视跳动科技</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">传播最前沿的科技知识！</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/avdance" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="https://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.avdancedu.com/a5b21a51/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="image" content="/images/avdancelogo.jpg"><meta itemprop="name" content="音视跳动"><meta itemprop="description" content="传输最前沿的科技知识，学习音视频的圣地！ffmpeg, webrtc, H264, AAC"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="音视跳动科技"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Windows下编译Chrome浏览器</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2023-03-01 13:16:00 / 修改时间：13:17:37" itemprop="dateCreated datePublished" datetime="2023-03-01T13:16:00+08:00">2023-03-01</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">浏览器</span></a></span></span><span id="/a5b21a51/" class="post-meta-item leancloud_visitors" data-flag-title="Windows下编译Chrome浏览器" title="阅读次数"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span class="leancloud-visitors-count"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span> <span class="post-meta-item-text">Valine：</span><a title="valine" href="/a5b21a51/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/a5b21a51/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>6.4k</span></span></div></header><div class="post-body" itemprop="articleBody"><p>随着技术的进步，浏览器在未来会扮演越来越得要的角色。我们基本可以确定，在不久的将来，大部分Native应用都会被Web应用所替代。因此，如果你想今后想找一份好工作，或写出更高效的Web应用，就必须要了解一下浏览器的工作原理。</p><p>了解浏览器工作原理的方法有很多，但对Chrome源码的阅读无缝是第一位的，只有这样我们才能获取第一手材料。</p><p>而阅读Chrome源码的第一位就是要能够下载或编译Chrome源码。而这篇文章就是告诉你如何下载并编译Chrome源码的。</p><span id="more"></span><h2 id="系统要求"><a href="#系统要求" class="headerlink" title="系统要求"></a>系统要求</h2><p>编译Chrome源码要满足以下几点要求：</p><ul><li>具有至少 8GB RAM 的 64 位 Intel 机器。<strong>这里强烈建议超过 16GB，我用的是 32GB</strong></li><li>NTFS 格式的文件系统，至少要有 100GB 可用的磁盘空间。<strong>注意，FAT32文件系统不能用于编译Chrome，因为一些 Git 文件大于 4GB</strong></li><li>编辑器需要使用 Visual Studio 2022</li><li>操作系统是 Windows 10 或更新版本</li></ul><h2 id="安装Visual-Studio"><a href="#安装Visual-Studio" class="headerlink" title="安装Visual Studio"></a>安装Visual Studio</h2><p>编译 Chromium 源码我们需要安装 <strong>Visual Studio 2022 (&gt;&#x3D;17.0.0)</strong> 才行。虽然编译和调试 Chromium 使用的是 <strong>clang-cl</strong> 编译器，但它需要 Visual Studio 的一些头文件、库和工具。</p><p>当然，Visual Studio最好选择专业版，但如果你没有专业版的License，也可以使用社区版，即 <strong>Visual Studio Community Edition</strong>。</p><p>此外，在安装VS时，你还必须安装 <strong>“使用 C++ 进行桌面开发”</strong> 组件和 <strong>“MFC&#x2F;ATL 支持”</strong> 子组件。如何你不知道如何在安装界面中选择这些组件，可以使用下面的命令行安装：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ PATH_TO_INSTALLER.EXE ^</span><br><span class="line">--add Microsoft.VisualStudio.Workload.NativeDesktop ^</span><br><span class="line">--add Microsoft.VisualStudio.Component.VC.ATLMFC ^</span><br><span class="line">--includeRecommended</span><br></pre></td></tr></table></figure><h2 id="安装Windows-SDK"><a href="#安装Windows-SDK" class="headerlink" title="安装Windows SDK"></a>安装Windows SDK</h2><p>编译Chrome源码，Windows SDK是少不了的，它对SDK有如下要求：</p><ul><li>你必须安装 <code>10.0.22621.0</code> 版本的<strong>Windows 11 SDK</strong>。注意，<strong>即使在Win10系统下，也要安装Windows 11 的SDK，这一点特别重要</strong></li><li><a target="_blank" rel="noopener" href="https://developer.microsoft.com/en-us/windows/downloads/windows-sdk/">Windows SDK</a> 可以单独安装，也可以通过 Visual Studio 来安装。这里建议采用单独的方式安装。<strong>安装好Windows SDK 后，记得要重启一下系统</strong>。</li><li>安装Window SDK时，还必须安装 10.0.22621.755 (Windows 11) SDK 调试工具，以支持 Chrome 能访问大于 4 GiB PDB 的大页面。如果你不知道该如何选择的话，建议你安装Windows SDK时，<strong>将所有选项都勾选上</strong>，否则后面编译时会出现各种头文件找不到的情况。</li></ul><h2 id="安装depot-tools"><a href="#安装depot-tools" class="headerlink" title="安装depot_tools"></a>安装depot_tools</h2><p>首先，从这里下载 <a target="_blank" rel="noopener" href="https://storage.googleapis.com/chrome-infra/depot_tools.zip">depot_tools</a> 包，并将其解压到某个目录下，例如：C:\src\depot_tools。</p><blockquote><p>注意：解压缩时，不要采用拖放或复制粘贴的方式提取。这种方法无法将隐藏的 <strong>“.git”</strong> 文件夹提取出来，而这是 depot_tools 自动更新时所必需的。</p></blockquote><p>之后，将 depot_tools 添加到 PATH 环境变量的开头（必须在任何 Python 安装之前）。</p><p>假设你将depot_tools解压到了 C:\src\depot_tools目录下，打开：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">控制面板 → 系统和安全 → 系统 → 高级系统设置</span><br></pre></td></tr></table></figure><p>如果你有管理员权限，请修改 PATH 系统环境变量，将C:\src\depot_tools放到PATH的最前面（或至少放在可能已经有 Python 或 Git 副本的任何目录的前面）。</p><p>如果您没有管理员权限，可以将其添加到用户级 PATH 环境变量中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">控制面板→系统和安全→系统→搜索“为您的帐户编辑环境变量”</span><br></pre></td></tr></table></figure><p>不过，在没有管理员权限的情况下，当你的系统 PATH 中已经指定了Python路径，那么你就无法使用depot_tools中的python了。这将导致你无法顺利的将源码下载下来。所以 <strong>建议你还是找台有管理员权限的主机</strong>。</p><p>另外，还要在环境变是中添加 DEPOT_TOOLS_WIN_TOOLCHAIN 变量，并将其设置为 0。这会告诉 depot_tools 使用本地安装的 Visual Studio （默认情况下，depot_tools 将尝试使用 google 内部版本）。</p><p>除此之外，你还须设置一个名为 <strong>vs2022_install</strong>的环境变量，用于指定vs2022 的安装路径，如下所示:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set vs2022_install=C:\Program Files\Microsoft Visual Studio\2022\Professional</span><br></pre></td></tr></table></figure><p>之后，你就可以在 <strong>命令行窗口(CMD)</strong> 中运行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gclient</span><br></pre></td></tr></table></figure><p>来下载、更新必要的工具了。</p><p>首次运行gclient命令时， 它会安装一些特定的工具，如 msysgit 和 python。执行该命令时需要<strong>注意</strong>：</p><ul><li>如果您从 <strong>非命令行(CMD)</strong> 中（例如，cygwin、PowerShell）运行 gclient，它看起来可能运行正常，但 msysgit、python 以及其他工具却无法正确安装。所以你必须在标准的命令行窗口中运行glient</li><li>如果你第一次运行 gclient 时，看到一些陌生的错误，你可能需要禁用<a target="_blank" rel="noopener" href="https://tortoisesvn.net/faq.html#cantmove2">Windows Indexing</a></li></ul><h2 id="检查-python-安装"><a href="#检查-python-安装" class="headerlink" title="检查 python 安装"></a>检查 python 安装</h2><p><code>gclient</code>执行完成后，在命令行窗口中键入<code>where python</code>，确认 <strong>depot_tools</strong> 中的<code>python.bat</code>位于任何其它 <code>python.exe</code> 之前。否则的话，会导致使用 gn 时出现构建失败，详细信息参见<a target="_blank" rel="noopener" href="https://crbug.com/611087">crbug.com&#x2F;611087</a>。</p><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/apps/desktop/modernize/desktop-to-uwp-extensions#alias">App Execution Aliases</a>这项服务可能与系统上安装的其他 python 有冲突，因此，需要将它关闭掉，具体方法是打开控制面板中的 <strong>“App execution aliases”</strong>，勾掉指向“python.exe”和“python3.exe”的复选框来禁用它们。</p><h2 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h2><p>由于众所周知的原因，在国内是不能直接下载Chrome源码的。因此，你要找一个靠谱的代理软件，而且给它一个最大的带宽。</p><p>我在下载的过程中，就由于网络的原因失败了好几次，既浪费的时间又浪费的金钱。</p><p>后来不得以，购买了10M的专线才好不容易将代码下载成功。</p><h2 id="获取代码"><a href="#获取代码" class="headerlink" title="获取代码"></a>获取代码</h2><p>首先，配置 Git：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name &quot;My Name&quot;</span><br><span class="line">$ git config --global user.email &quot;my-name@chromium.org&quot;</span><br><span class="line">$ git config --global core.autocrlf false</span><br><span class="line">$ git config --global core.filemode false</span><br><span class="line">$ git config --global branch.autosetuprebase always</span><br></pre></td></tr></table></figure><p>接着，创建一个chromium目录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir chromium &amp;&amp; cd chromium</span><br></pre></td></tr></table></figure><p>之后，运行<code>fetch</code>命令，将代码及其依赖check out出来：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ fetch chromium</span><br></pre></td></tr></table></figure><p><strong>如果在checkout时，你不想要完整的repo历史记录，你可以给fetch添加<code>--no-history</code>标志，这样可以减少你获取代码的时间。</strong></p><p>获取代码时，即使你网络很快，预计也要会花费一个多小时才能将它下载下来。而在较慢的网络上，则需要数个小时。所以，您必须配置好你的PC，使它在获取代码时不要休眠，否则失败了还要重新下。</p><p><strong>如果在获取子仓库时发生错误</strong>，你可以选择重新开始，或者进入到 <strong>chromium&#x2F;src</strong> 目录，执行下面的命令来继续下载：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gclient sync</span><br></pre></td></tr></table></figure><p>完成fetch后，它将创建一个隐藏的 <strong>.gclient</strong> 文件和一个 <strong>src</strong> 的目录。接下来，你需要切换到src目录下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cd src</span><br></pre></td></tr></table></figure><h2 id="构建项目"><a href="#构建项目" class="headerlink" title="构建项目"></a>构建项目</h2><p>Chromium 使用 <strong>Ninja</strong> 作为其主要构建工具，并使用名为 <strong>GN</strong> 的工具来生成.ninja文件。您可以创建任意数量的具有不同配置的构建目录。命令如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gn gen out/Default</span><br></pre></td></tr></table></figure><ul><li>您只需为每个新的构建目录运行一次，Ninja 将根据需要更新构建文件。</li><li>可以将Default换成别的名字，但应该在out子目录下。</li><li>对于其他构建参数，包括Release设置或使用 Visual Studio 的版本，请参阅 <a target="_blank" rel="noopener" href="https://www.chromium.org/developers/gn-build-configuration">GN build configuration</a>。默认创建的是与当前操作系统和CPU匹配的Debug版本。</li><li>有关 GN 的更多信息，可以运行<code>gn help</code>阅读<a target="_blank" rel="noopener" href="https://gn.googlesource.com/gn/+/main/docs/quick_start.md">快速入门指南</a>。</li></ul><h2 id="编译Chromium"><a href="#编译Chromium" class="headerlink" title="编译Chromium"></a>编译Chromium</h2><p>可以使用以下命令构建 Chromium（“chrome”目标）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ autoninja - C out \Default chrome</span><br></pre></td></tr></table></figure><p>autoninja是一个包装器，它会为ninja提供最佳的参数。</p><p>关于一些参数的详细信息，可以通过 <code>gn ls out/Default</code>获取。</p><h2 id="更快的编译"><a href="#更快的编译" class="headerlink" title="更快的编译"></a>更快的编译</h2><p>我们可以通过下面的方法来加快编译速度：</p><ul><li>关闭防病毒软件，从而减少文件系统开销</li><li>将构建树存储在快速磁盘（最好是 SSD）上</li><li>内核越多越好，即使 64GB 也不算多</li></ul><p>还有一些 gn 参数可以提高构建速度，可以考虑使用的一些设置如下：</p><ul><li>is_component_build &#x3D; true，这会使用更多、更小的 DLL，并且可以避免每次更改后都必须重新链接 chrome.dll。</li><li>enable_nacl &#x3D; false，这会禁用本地构建通常不需要的 Native Client。</li><li>target_cpu &#x3D; “x86”，x86 构建可能比 x64 构建稍快。请注意，如果您设置了它，但不设置enable_nacl &#x3D; false，那么构建时间可能会变得更糟。</li><li>blink_symbol_level &#x3D; 0，关闭 blink 的源代码级调试以减少构建时间，如果您不打算调试 blink，可以这么干。</li><li>v8_symbol_level &#x3D; 0，关闭 v8 的源代码级调试以减少构建时间，如果您不打算调试 v8，可以这么干。</li></ul><p>为了加快链接速度，您可以设置symbol_level&#x3D;1 或 symbol_level&#x3D;0，这些选项减少编译器和链接器所做的工作：</p><ul><li>symbol_level &#x3D; 1，指明编译器要发出文件名和行号信息，因此您仍然可以进行源代码级调试，但不会有局部变量或类型信息。</li><li>symbol_level &#x3D; 0，表示没有源代码级调试，但调用堆栈仍然有函数名称。</li><li>此外，更改symbol_level需要重新编译所有内容。</li></ul><p>另外，谷歌员工应该使用分布式编译系统goma。详细信息可在内部获得，但相关的 gn arg 是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use_goma = true</span><br></pre></td></tr></table></figure><p>要从 goma 中获得任何好处，重要的是将大的 -j 值传递给 ninja。一个好的默认值是 10<em>numCores 到 20</em>numCores。如果你运行 autoninja， 那么它会自动将适当的 -j 值传递给 ninja 是否为 goma。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ autoninja - C out \Default chrome</span><br></pre></td></tr></table></figure><p>调用 ninja 时，可以执定要编译的目标，如将 <strong>“chrome”</strong> 指定为目标，以避免同时构建所有测试二进制文件。</p><p><strong>尽管如此，在许多机器上构建仍需要花费数小时。</strong></p><h2 id="运行-Chromium"><a href="#运行-Chromium" class="headerlink" title="运行 Chromium"></a>运行 Chromium</h2><p>编译完成后，你就可以运行编译出的浏览器了：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$out\Default\chrome.exe</span><br></pre></td></tr></table></figure><h2 id="运行测试目标"><a href="#运行测试目标" class="headerlink" title="运行测试目标"></a>运行测试目标</h2><p>您可以用下面的方式运行测试。还可以使用 arg 限制运行哪些测试 <code>--gtest_filter</code>，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$out\Default\unit_tests.exe --gtest_filter = &quot;PushClientTest.*&quot;</span><br></pre></td></tr></table></figure><p>这些参数可以在其<a target="_blank" rel="noopener" href="https://github.com/google/googletest">GitHub页面</a>上找到更多有关 GoogleTest 的信息。</p><h2 id="更新checkout"><a href="#更新checkout" class="headerlink" title="更新checkout"></a>更新checkout</h2><p>更新存在的代码，可以运行下面的命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git rebase-update</span><br><span class="line">$ gclient sync -D</span><br></pre></td></tr></table></figure><ul><li><p>第一个命令，更新 Chromium 的主要源代码仓库，并重新设置任何本地分支。如果你不想使用这个脚本，你也可以使用git pull或其他常用的 Git 命令来更新 repo。</p></li><li><p>第二个命令，将子仓库同步到适当的版本，删除不再需要的版本，并根据需要重新与运行挂钩。</p></li></ul><h2 id="使用-Visual-Studio-IDE-进行编辑和调试"><a href="#使用-Visual-Studio-IDE-进行编辑和调试" class="headerlink" title="使用 Visual Studio IDE 进行编辑和调试"></a>使用 Visual Studio IDE 进行编辑和调试</h2><p>您可以使用 Visual Studio IDE 编辑和调试 Chrome。</p><h3 id="使用-Visual-Studio-Intellisense（智能感知）"><a href="#使用-Visual-Studio-Intellisense（智能感知）" class="headerlink" title="使用 Visual Studio Intellisense（智能感知）"></a>使用 Visual Studio Intellisense（智能感知）</h3><p>如果您想在开发 Chromium 时使用 Visual Studio Intellisense，请在生成输出目录时使用–ide命令行参数。这是一个示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gn gen -- ide = vs --ninja-executable=C:\src\chromium\src\third_party\ninja\ninja.exe out\Default </span><br><span class="line">$ devenv out\Default\all.sln</span><br></pre></td></tr></table></figure><p>GN 将在您的构建目录中生成一个all.sln文件。其在内部使用 Ninja 进行编译。如果您再次手动运行“gen”，你需要重新提供此参数，但通常 GN 会在构建时自动将构建与IDE文件保持一致。</p><p>另外，由于生成的解决方案中包含数千个项目，因此加载速度非常慢。可以使用 <strong>–filters</strong> 参数来限制你感兴趣的代码生成在项目文件中。当然，这样也会限制一些文件无法在项目资源管理器中出现，但调试仍然有效。您可以手动打开文件，设置断点。极端情况下，最小的solution中不包含任何文件，但仍然可以让你在VS中编译和运行Chrome。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gn gen --ide=vs --ninja-executable=C:\src\chromium\src\third_party\ninja\ninja.exe --filters=//chrome --no-deps out\Default</span><br></pre></td></tr></table></figure><p>您可以有选择地将您关心的其他目录添加到过滤器中，如下所示<code>--filters=//chrome;//third_party/WebKit/*;//gpu/*</code></p><p>更多的信息请运行 gn help gen 查看相关的文档。</p><h3 id="在没有-Intellisense-的情况下使用-Visual-Studio"><a href="#在没有-Intellisense-的情况下使用-Visual-Studio" class="headerlink" title="在没有 Intellisense 的情况下使用 Visual Studio"></a>在没有 Intellisense 的情况下使用 Visual Studio</h3><p>没有 Intellisense，你仍然可以在 Visual Studio 中调试和开发 Chrome。你只需在</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">File-&gt;Open-&gt;Project/Solution</span><br></pre></td></tr></table></figure><p>中，打开chrome.exe 这个二进制文件，或在命令窗口中输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">devenv /debugexe out\Debug\chrome.exe &lt;your arguments&gt;</span><br></pre></td></tr></table></figure><p>即可。</p><p>在这种情况下，就不能浏览代码了，但通过安装<a target="_blank" rel="noopener" href="https://chromium.github.io/vs-chromium/">VsChromium Visual Studio Extension</a>，可以获得源代码以及其他有用的功能（例如代码搜索）。</p><p>当然，你也可以将多个感兴趣的可执行文件，如base_unittests.exe、browser_tests.exe，添加到你的解决方案中，右键单击Solution Explorer，设置调试的程序为 <strong>Set as Startup Project</strong>。</p><p>默认情况下，当您在 Visual Studio 中开始调试时，调试器将仅附加到浏览器的主进程。要调试所有 Chrome，请安装Microsoft 的 <strong>Child Process Debugging Power Tool</strong> 工具。此外，您还需要以管理员身份运行 Visual Studio，否则它会默认是无法附加到 Chrome 的某些子进程的。</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>以上就是下载和编译Windows Chromium源码的过程。在源码的下载过程中很容易失败，解决的办法是首先保障你的网络是可以正确的、高质量的访问外网，这一步是最关键的，之后如果失败了就多次偿试。</p><p>总之一句话，有好的、高质量的、高速的带宽是你下载Chrome源码的关键。</p></div><div class="reward-container"><div></div> <button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'> 打赏</button><div id="qr" style="display:none"><div style="display:inline-block"> <img src="https://cdn.avdancedu.com/image/next/wechat.jpeg" alt="音视跳动 微信支付"><p>微信支付</p></div><div style="display:inline-block"> <img src="https://cdn.avdancedu.com/image/next/alipay.jpeg" alt="音视跳动 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 音视跳动-李超 [avdance@163.com]</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://blog.avdancedu.com/a5b21a51/" title="Windows下编译Chrome浏览器">https://blog.avdancedu.com/a5b21a51/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><p>欢迎关注我的其它发布渠道</p><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="https://cdn.avdancedu.com/image/next/WeChat.jpeg"><span class="icon"><i class="fa fa-wechat"></i></span> <span class="label">WeChat</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Chrome/" rel="tag"><i class="fa fa-tag"></i> Chrome</a><a href="/tags/windows/" rel="tag"><i class="fa fa-tag"></i> windows</a></div><div class="post-nav"><div class="post-nav-item"><a href="/6373ddbf/" rel="prev" title="网络开发点滴.md"><i class="fa fa-chevron-left"></i> 网络开发点滴.md</a></div><div class="post-nav-item"> <a href="/52f625ca/" rel="next" title="揭密OpenVPN工作原理">揭密OpenVPN工作原理<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E8%A6%81%E6%B1%82"><span class="nav-number">1.</span> <span class="nav-text">系统要求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Visual-Studio"><span class="nav-number">2.</span> <span class="nav-text">安装Visual Studio</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Windows-SDK"><span class="nav-number">3.</span> <span class="nav-text">安装Windows SDK</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85depot-tools"><span class="nav-number">4.</span> <span class="nav-text">安装depot_tools</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5-python-%E5%AE%89%E8%A3%85"><span class="nav-number">5.</span> <span class="nav-text">检查 python 安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C"><span class="nav-number">6.</span> <span class="nav-text">配置网络</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E4%BB%A3%E7%A0%81"><span class="nav-number">7.</span> <span class="nav-text">获取代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="nav-number">8.</span> <span class="nav-text">构建项目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%96%E8%AF%91Chromium"><span class="nav-number">9.</span> <span class="nav-text">编译Chromium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%B4%E5%BF%AB%E7%9A%84%E7%BC%96%E8%AF%91"><span class="nav-number">10.</span> <span class="nav-text">更快的编译</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C-Chromium"><span class="nav-number">11.</span> <span class="nav-text">运行 Chromium</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95%E7%9B%AE%E6%A0%87"><span class="nav-number">12.</span> <span class="nav-text">运行测试目标</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0checkout"><span class="nav-number">13.</span> <span class="nav-text">更新checkout</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-Visual-Studio-IDE-%E8%BF%9B%E8%A1%8C%E7%BC%96%E8%BE%91%E5%92%8C%E8%B0%83%E8%AF%95"><span class="nav-number">14.</span> <span class="nav-text">使用 Visual Studio IDE 进行编辑和调试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-Visual-Studio-Intellisense%EF%BC%88%E6%99%BA%E8%83%BD%E6%84%9F%E7%9F%A5%EF%BC%89"><span class="nav-number">14.1.</span> <span class="nav-text">使用 Visual Studio Intellisense（智能感知）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8%E6%B2%A1%E6%9C%89-Intellisense-%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%E4%BD%BF%E7%94%A8-Visual-Studio"><span class="nav-number">14.2.</span> <span class="nav-text">在没有 Intellisense 的情况下使用 Visual Studio</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">15.</span> <span class="nav-text">小结</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="https://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="音视跳动" src="/images/avdancelogo.jpg"><p class="site-author-name" itemprop="name">音视跳动</p><div class="site-description" itemprop="description">传输最前沿的科技知识，学习音视频的圣地！ffmpeg, webrtc, H264, AAC</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">70</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">26</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">46</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/avdance" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;avdance" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/garrylea/posts" title="ZhiHu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;garrylea&#x2F;posts" rel="noopener" target="_blank"><i class="fa fa-fw fa-zhihu"></i> ZhiHu</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="https://www.beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备19056322号-1</a> <img src="/images/beianico.png" style="display:inline-block"><a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11011102001366" rel="noopener" target="_blank">京公网安备11011102001366号</a></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2023</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">李超</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span title="站点总字数">276k</span></div><script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"Cu6h7B3RnNt3uEMrRWpVlIU6-gzGzoHsz","app_key":"5dKv9XFD2w3gjJnb0xnWIIWz","server_url":"https://leancloud.cn","security":false};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        //if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("Cu6h7B3RnNt3uEMrRWpVlIU6-gzGzoHsz","5dKv9XFD2w3gjJnb0xnWIIWz")</script><script>function showTime(e){var t=new AV.Query(e),c=[],u=$(".leancloud_visitors");u.each(function(){c.push($(this).attr("id").trim())}),t.containedIn("url",c),t.find().done(function(e){var t=".leancloud-visitors-count";if(0!==e.length){for(var n=0;n<e.length;n++){var o=e[n],i=o.get("url"),s=o.get("time"),r=document.getElementById(i);$(r).find(t).text(s)}for(n=0;n<c.length;n++){i=c[n],r=document.getElementById(i);var l=$(r).find(t);""==l.text()&&l.text(0)}}else u.find(t).text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(i){var e=$(".leancloud_visitors"),s=e.attr("id").trim(),r=e.attr("data-flag-title").trim(),t=new AV.Query(i);t.equalTo("url",s),t.find({success:function(e){if(0<e.length){var t=e[0];t.fetchWhenSave(!0),t.increment("time"),t.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var n=new i,o=new AV.ACL;o.setPublicReadAccess(!0),o.setPublicWriteAccess(!0),n.setACL(o),n.set("title",r),n.set("url",s),n.set("time",1),n.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):1<$(".post-title-link").length&&showTime(e)})</script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.min.css"><script src="/lib/needsharebutton/needsharebutton.min.js"></script><script>flOptions={iconStyle:"box",boxForm:"horizontal",position:"topRight",networks:"Weibo,Wechat,QQZone"},new needShareButton("#needsharebutton-float",flOptions)</script><script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('/lib/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'Cu6h7B3RnNt3uEMrRWpVlIU6-gzGzoHsz',
      appKey     : '5dKv9XFD2w3gjJnb0xnWIIWz',
      placeholder: "畅所欲言？",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script></body></html>